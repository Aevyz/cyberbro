{% set criminalip = analysis_results.results[0].criminalip %}

<div class="card">
    <h2>Criminal IP</h2>

    <p><strong>Abuse Record Count</strong>: {{ criminalip.abuse_record_count }} </p>

{% if criminalip.score %}
    <div><h3>Score</h3>
        <p><strong>Inbound:</strong> {{ criminalip.score.inbound }}<br>
        <strong>Outbound:</strong> {{ criminalip.score.outbound }}</p>
    </div>
{% endif %}

{% if criminalip.issues %}
    <div>
    <h2>Issues</h2>
    <p><ul>
    {% for issue_name, value in criminalip.issues.items() %}
        <li> {{ issue_name }}: {{ value }} </li>
    {% endfor %}
    </ul></p>
    </div>
{% endif %}

{% if criminalip.ids.count > 0 %}
    <div>
    <h2>IDS</h2>
    <div><ul>
    {% for ids in criminalip.ids.data %}
        <li>Classification: {{ ids.classification }}<br>
        Confirmed Time: {{ ids.confirmed_time }}<br>
        Message: {{ ids.message }}<br>
        Source System: {{ ids.source_system }}<br>
        Url: {{ ids.url }}</li>
    {% endfor %}
    </ul></div>
    </div>
{% endif %}

{% if criminalip.current_opened_port and criminalip.current_opened_port.count > 0 %}
    <h3>Current Open Ports</h3>
    {% for port in criminalip.current_opened_port.data %}
        <div><ul>
            <li><strong>Port</strong>: {{ port.port }}<br>
        Vulnerability: {{ port.is_vulnerability }}<br>
        Product Name: {{ port.product_name }}<br>
        {% if port.protocol %}
            Protocol: {{ port.protocol }}<br>
        {% endif %}
        Socket Type: {{ port.socket_type }}</li></ul>
        </div>
        {% endfor %}
{% endif %}

{% if criminalip.represenative_domain %}
    <p><strong>Representative Domain</strong>: {{ criminalip.represenative_domain }}</p>
{% endif %}
</div>
